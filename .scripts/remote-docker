#!/bin/zsh

if [ -z "$1" ]; then
	if [ -z "$OLD_POWERLEVEL9k" ]; then OLD_POWERLEVEL9K=${POWERLEVEL9K_LEFT_PROMPT_ELEMENTS}; fi
	export DOCKER_HOST=unix:///var/run/docker.sock
	export POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=${OLD_POWERLEVEL9K}
	unset http_proxy
else
	NODE=${2:-1}

	case $1:u in
	DMZ)
		export DOCKER_HOST=tcp://swarm$NODE.dmz.home.lecat.network:2375
		export DOCKER_ENV=dmz
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	SECURE)
		export DOCKER_HOST=tcp://swarm$NODE.secure.home.lecat.network:2375
		export DOCKER_ENV=secure
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	ZBX-DMZ)
		export DOCKER_HOST=tcp://zabbix-proxy.dmz.home.lecat.network:2375
		export DOCKER_ENV=zbx-dmz
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	STORAGE)
		export DOCKER_HOST=tcp://storage.secure.home.lecat.network:2375
		export DOCKER_ENV=storage
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	PLEX)
		export DOCKER_HOST=tcp://plex.secure.home.lecat.network:2375
		export DOCKER_ENV=plex
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	SMOKEPING-HOME)
		export DOCKER_HOST=tcp://smokeping.dmz.home.lecat.network:2375
		export DOCKER_ENV=smokeping-home
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	SMOKEPING-OSC)
		export DOCKER_HOST=tcp://smokeping.dmz.osc.lecat.network:2375
		export DOCKER_ENV=smokeping-osc
		export http_proxy=http://adm.secure.home.lecat.network:3128
		;;
	esac

	export OLD_POWERLEVEL9K=${POWERLEVEL9K_LEFT_PROMPT_ELEMENTS}
	export POWERLEVEL9K_CUSTOM_SWARM_BACKGROUND="white"
	export POWERLEVEL9K_CUSTOM_SWARM="echo üê≥ $DOCKER_ENV:u"
	export POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(custom_swarm dir vcs)
fi
